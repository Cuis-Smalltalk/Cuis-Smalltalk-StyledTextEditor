'From Cuis 3.3 of 2 June 2011 [latest update: #1024] on 4 November 2011 at 10:40:10 am'!Object subclass: #StyledTextWiki	instanceVariableNames: 'textModel pages currentPage'	classVariableNames: ''	poolDictionaries: ''	category: 'StyledTextWiki'!StyledTextWiki class	instanceVariableNames: ''!Object subclass: #StyledTextWikiEditor	instanceVariableNames: 'wiki textMorph'	classVariableNames: ''	poolDictionaries: ''	category: 'StyledTextWiki'!StyledTextWikiEditor class	instanceVariableNames: ''!Object subclass: #StyledTextWikiPage	instanceVariableNames: 'wiki text'	classVariableNames: ''	poolDictionaries: ''	category: 'StyledTextWiki'!StyledTextWikiPage class	instanceVariableNames: ''!!StyledTextWikiEditor commentStamp: 'jmv 5/24/2011 10:57' prior: 0!                 (StyledTextWikiEditor new	setWiki: StyledTextWiki new;	createMorph) openInWorld	(StyledTextWikiEditor new	setWiki: StyledTextWiki new;	morphicWindow) openInWorld!!StyledTextWikiEditor methodsFor: 'as yet unclassified' stamp: 'jmv 8/10/2011 11:02'!createMorph	| appMorph pagesList toolbar |	appMorph := SystemWindow createStyledTextEditor: wiki textModel in: STEMainMorph newColumn.	textMorph := appMorph submorphs first.	pagesList := PluggableFilteringDropDownListMorph		model: self		listGetter: #pageNames		indexGetter: #currentPageIndex		indexSetter: #currentPageIndex:.	toolbar := appMorph submorphs last.	pagesList		borderWidth: 0;		layoutSpec: (LayoutSpec morphHeightProportionalWidth: 0.5).	toolbar addMorphBack: pagesList.	"add it at the left of the layout"	appMorph adoptWidgetsColor: wiki textModel class windowColor.	textMorph when: #possiblyChanged send: #modelChanged to: pagesList.	^appMorph! !!StyledTextWiki methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 16:58'!          currentPage	^currentPage! !!StyledTextWiki methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 17:00'!                  currentPageIndex	^pages indexOf: currentPage! !!StyledTextWikiEditor methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 17:00'!                        currentPageIndex	^wiki currentPageIndex! !!StyledTextWiki methodsFor: 'as yet unclassified' stamp: 'jmv 8/10/2011 10:55'!   currentPageIndex: anInteger	currentPage := pages at: anInteger.	textModel actualContents: currentPage text! !!StyledTextWikiEditor methodsFor: 'as yet unclassified' stamp: 'jmv 8/10/2011 10:59'!                         currentPageIndex: anInteger	(anInteger = self pageNames size)		ifTrue: [wiki newPage]		ifFalse: [wiki currentPageIndex: anInteger]! !!StyledTextWiki methodsFor: 'as yet unclassified' stamp: 'jmv 8/10/2011 10:56'!      initialize	| heading1 |	textModel _ StyledTextModel new.	heading1 _ textModel styleSet paragraphStyleNamed: 'Heading 1'.	pages := OrderedCollection new.	currentPage := self newPage: (		Text			string: 'Welcome to the Styled Text Wiki!!'			attribute: (ParagraphStyleReference for: heading1)).	textModel actualContents: currentPage text! !!StyledTextWikiEditor methodsFor: 'as yet unclassified' stamp: 'jmv 5/24/2011 11:00'!               morphicWindow	| window |	window _ SystemWindow new model: self.	window setLabel: 'Styled Text Wiki'.	window layoutMorph		addMorph: (self createMorph)		proportionalHeight: 1.	^ window! !!StyledTextWikiPage methodsFor: 'as yet unclassified' stamp: 'jmv 6/9/2011 10:38'!           name	| string lineLength |	string := self text asString.	lineLength := string indexOf: Character cr.	 lineLength := lineLength = 0 ifTrue: [ string size ] ifFalse: [ lineLength - 1 ].	string := string copyFrom: 1 to: (30 min: lineLength).	string ifEmpty: [^'(Empty page)'].	^string! !!StyledTextWiki methodsFor: 'as yet unclassified' stamp: 'jmv 8/10/2011 10:55'!           newPage	| normal |	normal _ textModel styleSet paragraphStyleNamed: 'Normal'.	currentPage := self newPage:		(Text string: '' attribute: (ParagraphStyleReference for: normal)).	textModel actualContents: currentPage text! !!StyledTextWiki methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 16:47'!            newPage: aText	^pages add: ((StyledTextWikiPage wiki: self)		text: aText;		yourself)! !!StyledTextWiki methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 16:39'!                    pageNames	^pages collect: [:each | each name]! !!StyledTextWikiEditor methodsFor: 'as yet unclassified' stamp: 'bp 10/25/2010 18:05'!                       pageNames	^wiki pageNames		add: '(New page)';		yourself! !!StyledTextWikiEditor methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 16:58'!           setWiki: aStyledTextWiki	wiki := aStyledTextWiki! !!StyledTextWikiPage methodsFor: 'as yet unclassified' stamp: 'jmv 8/10/2011 10:57'!                      setWiki: aStyledTextWiki	| normal |	wiki := aStyledTextWiki.	normal _ wiki textModel styleSet paragraphStyleNamed: 'Normal'.	text := Text string: '' attribute: (ParagraphStyleReference for: normal)! !!StyledTextWikiPage methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 16:17'!                              text	^text! !!StyledTextWikiPage methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 16:45'!                            text: aText	text := aText! !!StyledTextWiki methodsFor: 'as yet unclassified' stamp: 'jmv 8/10/2011 10:53'!                 textModel	^textModel! !!StyledTextWikiEditor class methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 16:56'!          wiki: aStyledTextWiki	^self new setWiki: aStyledTextWiki! !!StyledTextWikiPage class methodsFor: 'as yet unclassified' stamp: 'bp 10/24/2010 16:56'!        wiki: aStyledTextWiki	^self new setWiki: aStyledTextWiki! !